/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/modalities/config/component_factory.py:167: FutureWarning: With version 0.4, we upgraded FSDP to FSDP 2.0. Use get_fsdp_2_wrapped_model(...) and FSDP2WrappedModelConfig instead.
  comp_config = component_config_type(**config_dict, strict=True)
/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/modalities/config/component_factory.py:194: FutureWarning: With version 0.4, we upgraded FSDP to FSDP 2.0. Use GeneralModelFactory.get_fsdp2_wrapped_model(...) instead.
  component = component_type(**component_config_dict)
model_factory - INFO - Rank 0 unsharded number of parameters: 124439808
/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/torch/distributed/fsdp/_init_utils.py:430: UserWarning: FSDP is switching to use `NO_SHARD` instead of ShardingStrategy.FULL_SHARD since the world size is 1.
  warnings.warn(
model_factory - INFO - Rank 0 sharded number of parameters: 124439808
INFO:model_factory:Rank 0 sharded number of parameters: 124439808
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/modalities/__main__.py", line 104, in CMD_entry_point_run_modalities
[rank0]:     components = main_obj.build_components(components_model_type=TrainingComponentsInstantiationModel)
[rank0]:                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/modalities/main.py", line 85, in build_components
[rank0]:     components = self.component_factory.build_components(
[rank0]:                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/modalities/config/component_factory.py", line 42, in build_components
[rank0]:     component_dict = self._build_config(
[rank0]:                      ^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/modalities/config/component_factory.py", line 59, in _build_config
[rank0]:     components, _ = self._build_component(
[rank0]:                     ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/modalities/config/component_factory.py", line 83, in _build_component
[rank0]:     materialized_component_config[sub_entity_key], top_level_components = self._build_component(
[rank0]:                                                                           ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/modalities/config/component_factory.py", line 83, in _build_component
[rank0]:     materialized_component_config[sub_entity_key], top_level_components = self._build_component(
[rank0]:                                                                           ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/modalities/config/component_factory.py", line 83, in _build_component
[rank0]:     materialized_component_config[sub_entity_key], top_level_components = self._build_component(
[rank0]:                                                                           ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/modalities/config/component_factory.py", line 118, in _build_component
[rank0]:     materialized_referenced_component, top_level_components = self._build_component(
[rank0]:                                                               ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/modalities/config/component_factory.py", line 101, in _build_component
[rank0]:     component = self._instantiate_component(
[rank0]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/modalities/config/component_factory.py", line 194, in _instantiate_component
[rank0]:     component = component_type(**component_config_dict)
[rank0]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/modalities/optimizers/optimizer_factory.py", line 41, in get_adam_w
[rank0]:     optimizer_groups = get_optimizer_groups(wrapped_model, weight_decay, weight_decay_groups_excluded)
[rank0]:                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/modalities/optimizers/optimizer_factory.py", line 83, in get_optimizer_groups
[rank0]:     _assert_existence_of_weight_decay_groups_excluded(model, weight_decay_groups_excluded)
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/modalities/optimizers/optimizer_factory.py", line 116, in _assert_existence_of_weight_decay_groups_excluded
[rank0]:     raise OptimizerError(
[rank0]: modalities.exceptions.OptimizerError: group = embedding specified in weight_decay_groups_excluded is not in models optimizer_module_groups = []

[rank0]: The above exception was the direct cause of the following exception:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/bin/modalities", line 7, in <module>
[rank0]:     sys.exit(main())
[rank0]:              ^^^^^^
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/click/core.py", line 1485, in __call__
[rank0]:     return self.main(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/click/core.py", line 1406, in main
[rank0]:     rv = self.invoke(ctx)
[rank0]:          ^^^^^^^^^^^^^^^^
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/click/core.py", line 1873, in invoke
[rank0]:     return _process_result(sub_ctx.command.invoke(sub_ctx))
[rank0]:                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/click/core.py", line 1269, in invoke
[rank0]:     return ctx.invoke(self.callback, **ctx.params)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/click/core.py", line 824, in invoke
[rank0]:     return callback(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/modalities/__main__.py", line 121, in CMD_entry_point_run_modalities
[rank0]:     raise RuntimeError(f"An error occurred while running the training: {e}. ") from e
[rank0]: RuntimeError: An error occurred while running the training: group = embedding specified in weight_decay_groups_excluded is not in models optimizer_module_groups = []. 
E1229 14:02:43.295000 1063493 site-packages/torch/distributed/elastic/multiprocessing/api.py:882] failed (exitcode: 1) local_rank: 0 (pid: 1063510) of binary: /home/s472389/miniconda3/envs/modalities/bin/python3.11
Traceback (most recent call last):
  File "/home/s472389/miniconda3/envs/modalities/bin/torchrun", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 357, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/torch/distributed/run.py", line 936, in main
    run(args)
  File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/torch/distributed/run.py", line 927, in run
    elastic_launch(
  File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 156, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s472389/miniconda3/envs/modalities/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 293, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/s472389/miniconda3/envs/modalities/bin/modalities FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-12-29_14:02:43
  host      : jn103.julia.lan
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 1063510)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
srun: error: jn103: task 0: Exited with exit code 1
